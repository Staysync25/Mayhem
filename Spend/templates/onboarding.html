<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mayhem Metrics - Onboarding</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="text-center mb-4">
      <img src="{{ url_for('static', filename='logo.png') }}" alt="Mayhem Metrics Logo" style="max-height:80px;">
      <h1 class="h3 mt-3">Mayhem Metrics</h1>
      <p class="lead text-muted">Turn chaos into clarity.</p>
    </div>
    
    <!-- Progress Bar -->
    <div class="row justify-content-center mb-4">
      <div class="col-lg-8">
        <div class="progress-bg rounded-pill" style="height: 8px;">
          <div class="progress-bar rounded-pill" style="width: {{ (current_step / 8) * 100 }}%; height: 100%;"></div>
        </div>
        <div class="d-flex justify-content-between mt-2">
          <span class="text-muted small">Step {{ current_step }} of 8</span>
          <span class="text-muted small">{{ ((current_step / 8) * 100)|round }}%</span>
        </div>
      </div>
    </div>

    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card shadow-sm">
          <div class="card-body p-4 p-md-5">
            {% if current_step == 1 %}
              <!-- Step 1: Intro -->
              <div class="text-center">
                <h2 class="mb-4">Welcome to Mayhem Metrics</h2>
                <p class="lead mb-4">Get a comprehensive audit of your food costs and discover savings opportunities that can reduce your costs by 15-25%.</p>
                <form method="post" action="{{ url_for('onboarding_step', step=2) }}">
                  <button type="submit" class="btn btn-success btn-lg">Start free checkup</button>
                </form>
              </div>
            {% elif current_step == 2 %}
              <!-- Step 2: Business Basics -->
              <h2 class="mb-4">Tell us about your business</h2>
              <form method="post" action="{{ url_for('onboarding_step', step=3) }}">
                <div class="mb-3">
                  <label class="form-label">Business Name *</label>
                  <input type="text" name="business_name" class="form-control" value="{{ session.get('business_name', '') }}" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Website (optional)</label>
                  <input type="url" name="website" class="form-control" value="{{ session.get('website', '') }}" placeholder="https://yourrestaurant.com">
                </div>
                <div class="mb-3">
                  <label class="form-label">Number of Locations</label>
                  <select name="locations_count" class="form-control">
                    <option value="1" {% if session.get('locations_count') == '1' %}selected{% endif %}>1 location</option>
                    <option value="2" {% if session.get('locations_count') == '2' %}selected{% endif %}>2 locations</option>
                    <option value="3" {% if session.get('locations_count') == '3' %}selected{% endif %}>3 locations</option>
                    <option value="4" {% if session.get('locations_count') == '4' %}selected{% endif %}>4 locations</option>
                    <option value="5" {% if session.get('locations_count') == '5' %}selected{% endif %}>5+ locations</option>
                  </select>
                </div>
                <div class="mb-4">
                  <label class="form-label">Cuisine Type *</label>
                  <select name="cuisine_type" class="form-control" required>
                    <option value="">Select cuisine type</option>
                    <option value="American" {% if session.get('cuisine_type') == 'American' %}selected{% endif %}>American</option>
                    <option value="Italian" {% if session.get('cuisine_type') == 'Italian' %}selected{% endif %}>Italian</option>
                    <option value="Mexican" {% if session.get('cuisine_type') == 'Mexican' %}selected{% endif %}>Mexican</option>
                    <option value="Chinese" {% if session.get('cuisine_type') == 'Chinese' %}selected{% endif %}>Chinese</option>
                    <option value="Japanese" {% if session.get('cuisine_type') == 'Japanese' %}selected{% endif %}>Japanese</option>
                    <option value="Thai" {% if session.get('cuisine_type') == 'Thai' %}selected{% endif %}>Thai</option>
                    <option value="Indian" {% if session.get('cuisine_type') == 'Indian' %}selected{% endif %}>Indian</option>
                    <option value="Mediterranean" {% if session.get('cuisine_type') == 'Mediterranean' %}selected{% endif %}>Mediterranean</option>
                    <option value="French" {% if session.get('cuisine_type') == 'French' %}selected{% endif %}>French</option>
                    <option value="Steakhouse" {% if session.get('cuisine_type') == 'Steakhouse' %}selected{% endif %}>Steakhouse</option>
                    <option value="Seafood" {% if session.get('cuisine_type') == 'Seafood' %}selected{% endif %}>Seafood</option>
                    <option value="Fast Casual" {% if session.get('cuisine_type') == 'Fast Casual' %}selected{% endif %}>Fast Casual</option>
                    <option value="Pizza" {% if session.get('cuisine_type') == 'Pizza' %}selected{% endif %}>Pizza</option>
                    <option value="BBQ" {% if session.get('cuisine_type') == 'BBQ' %}selected{% endif %}>BBQ</option>
                    <option value="Other" {% if session.get('cuisine_type') == 'Other' %}selected{% endif %}>Other</option>
                  </select>
                </div>
                <div class="d-flex justify-content-between">
                  <a href="{{ url_for('onboarding_step', step=1) }}" class="btn btn-outline-secondary">Back</a>
                  <button type="submit" class="btn btn-success">Continue</button>
                </div>
              </form>
            {% elif current_step == 3 %}
              <!-- Step 3: Contact -->
              <h2 class="mb-4">Contact Information</h2>
              <form method="post" action="{{ url_for('onboarding_step', step=4) }}">
                <div class="mb-3">
                  <label class="form-label">Contact Name *</label>
                  <input type="text" name="contact_name" class="form-control" value="{{ session.get('contact_name', '') }}" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Phone Number *</label>
                  <input type="tel" name="phone" class="form-control" value="{{ session.get('phone', '') }}" required>
                </div>
                <div class="mb-4">
                  <label class="form-label">Email Address *</label>
                  <input type="email" name="email" class="form-control" value="{{ session.get('email', '') }}" required>
                  <div class="form-text">We'll send you a magic link to verify your email</div>
                </div>
                <div class="d-flex justify-content-between">
                  <a href="{{ url_for('onboarding_step', step=2) }}" class="btn btn-outline-secondary">Back</a>
                  <button type="submit" class="btn btn-success">Continue</button>
                </div>
              </form>
            {% elif current_step == 4 %}
              <!-- Step 4: Ops Snapshot -->
              <h2 class="mb-4">Operations Snapshot</h2>
              <form method="post" action="{{ url_for('onboarding_step', step=5) }}">
                <div class="mb-3">
                  <label class="form-label">Current Vendors *</label>
                  <textarea name="vendors" class="form-control" rows="3" required>{{ session.get('vendors', '') }}</textarea>
                  <div class="form-text">List your main vendors (e.g., Sysco, US Foods, local suppliers)</div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Monthly Food Spend ($) *</label>
                    <input type="number" name="monthly_spend" class="form-control" value="{{ session.get('monthly_spend', '') }}" required>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Current Food Cost %</label>
                    <input type="number" step="0.1" name="food_cost_pct" class="form-control" value="{{ session.get('food_cost_pct', '') }}">
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Inventory Frequency *</label>
                    <select name="inventory_frequency" class="form-control" required>
                      <option value="">Select frequency</option>
                      <option value="Weekly" {% if session.get('inventory_frequency') == 'Weekly' %}selected{% endif %}>Weekly</option>
                      <option value="Biweekly" {% if session.get('inventory_frequency') == 'Biweekly' %}selected{% endif %}>Biweekly</option>
                      <option value="Monthly" {% if session.get('inventory_frequency') == 'Monthly' %}selected{% endif %}>Monthly</option>
                      <option value="Inconsistent" {% if session.get('inventory_frequency') == 'Inconsistent' %}selected{% endif %}>Inconsistent</option>
                    </select>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Inventory Method</label>
                    <select name="inventory_method" class="form-control">
                      <option value="">Select method</option>
                      <option value="By area" {% if session.get('inventory_method') == 'By area' %}selected{% endif %}>By area</option>
                      <option value="By category" {% if session.get('inventory_method') == 'By category' %}selected{% endif %}>By category</option>
                      <option value="Recipe-level" {% if session.get('inventory_method') == 'Recipe-level' %}selected{% endif %}>Recipe-level</option>
                      <option value="Other" {% if session.get('inventory_method') == 'Other' %}selected{% endif %}>Other</option>
                    </select>
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">Systems Used</label>
                  <input type="text" name="systems_used" class="form-control" value="{{ session.get('systems_used', '') }}" placeholder="e.g., Toast, Square, QuickBooks, Excel">
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Prime Vendor %</label>
                    <input type="number" name="prime_vendor_pct" class="form-control" value="{{ session.get('prime_vendor_pct', '') }}">
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Monthly Sales ($)</label>
                    <input type="number" name="monthly_sales" class="form-control" value="{{ session.get('monthly_sales', '') }}">
                  </div>
                </div>
                <div class="mb-4">
                  <label class="form-label">Goals (optional)</label>
                  <textarea name="goals" class="form-control" rows="2">{{ session.get('goals', '') }}</textarea>
                  <div class="form-text">What are your main goals? (e.g., reduce food costs, improve inventory accuracy, find new vendors)</div>
                </div>
                <div class="d-flex justify-content-between">
                  <a href="{{ url_for('onboarding_step', step=3) }}" class="btn btn-outline-secondary">Back</a>
                  <button type="submit" class="btn btn-success">Continue</button>
                </div>
              </form>
            {% elif current_step == 5 %}
              <!-- Step 5: Value Framing -->
              <div class="text-center">
                <h2 class="mb-4">We turn invoices into an actionable savings plan.</h2>
                <p class="lead mb-4">Spot price gaps by category, vendor leverage, and quick wins that move food cost down.</p>
                
                <div class="card mb-4">
                  <div class="card-body">
                    <h3 class="h5 mb-3">What you'll get this week:</h3>
                    <ul class="list-unstyled text-start">
                      <li class="mb-2">✓ A prioritized savings report with specific recommendations</li>
                      <li class="mb-2">✓ Vendor comparison matrix showing price differences</li>
                      <li class="mb-2">✓ A short list of negotiation targets for this month</li>
                    </ul>
                  </div>
                </div>
                
                <div class="row mb-4">
                  <div class="col-md-4 text-center">
                    <div class="h3 text-success">15-25%</div>
                    <div class="text-muted">Average Savings</div>
                  </div>
                  <div class="col-md-4 text-center">
                    <div class="h3 text-success">5-7</div>
                    <div class="text-muted">Days to Results</div>
                  </div>
                  <div class="col-md-4 text-center">
                    <div class="h3 text-success">500+</div>
                    <div class="text-muted">Restaurants Helped</div>
                  </div>
                </div>
                
                <form method="post" action="{{ url_for('onboarding_step', step=6) }}">
                  <div class="d-flex justify-content-between">
                    <a href="{{ url_for('onboarding_step', step=4) }}" class="btn btn-outline-secondary">Back</a>
                    <button type="submit" class="btn btn-success">Choose Your Plan</button>
                  </div>
                </form>
              </div>
            {% elif current_step == 6 %}
              <!-- Step 6: Plan Selection -->
              <h2 class="mb-4">Choose Your Plan</h2>
              <form method="post" action="{{ url_for('onboarding_step', step=7) }}">
                <div class="row">
                  <div class="col-md-4 mb-4">
                    <div class="card h-100 {% if session.get('plan_tier') == '1' %}border-success{% endif %}">
                      <div class="card-body text-center">
                        <h3 class="h5">Tier 1</h3>
                        <h4 class="h6 text-muted">Purchase Review & Opportunity Report</h4>
                        <div class="h4 text-success mb-3">$299</div>
                        <ul class="list-unstyled text-start small">
                          <li>• Audit last 4–8 weeks of invoices & price lists</li>
                          <li>• Savings by brand/pack/vendor with benchmarks</li>
                          <li>• Prioritized action plan</li>
                        </ul>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="plan_tier" value="1" id="plan1" {% if session.get('plan_tier') == '1' %}checked{% endif %}>
                          <label class="form-check-label" for="plan1">Select Tier 1</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4">
                    <div class="card h-100 {% if session.get('plan_tier') == '2' %}border-success{% endif %}">
                      <div class="card-body text-center">
                        <div class="badge bg-success mb-2">Most Popular</div>
                        <h3 class="h5">Tier 2</h3>
                        <h4 class="h6 text-muted">Vendor Negotiation & Price Comparisons</h4>
                        <div class="h4 text-success mb-3">$599</div>
                        <ul class="list-unstyled text-start small">
                          <li>• Everything in T1, plus:</li>
                          <li>• We negotiate with current vendors</li>
                          <li>• Cross-vendor price comps (incl. new vendors)</li>
                          <li>• Savings locked in writing</li>
                        </ul>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="plan_tier" value="2" id="plan2" {% if session.get('plan_tier') == '2' %}checked{% endif %}>
                          <label class="form-check-label" for="plan2">Select Tier 2</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-4">
                    <div class="card h-100 {% if session.get('plan_tier') == '3' %}border-success{% endif %}">
                      <div class="card-body text-center">
                        <h3 class="h5">Tier 3</h3>
                        <h4 class="h6 text-muted">Month-End Inventory Audit</h4>
                        <div class="h4 text-success mb-3">$999</div>
                        <ul class="list-unstyled text-start small">
                          <li>• Everything in T1 & T2, plus:</li>
                          <li>• EOM inventory audit & variance review</li>
                          <li>• Count cadence/method tune-up</li>
                          <li>• Tie-out to theoretical vs. actual</li>
                        </ul>
                        <div class="form-check">
                          <input class="form-check-input" type="radio" name="plan_tier" value="3" id="plan3" {% if session.get('plan_tier') == '3' %}checked{% endif %}>
                          <label class="form-check-label" for="plan3">Select Tier 3</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="d-flex justify-content-between">
                  <a href="{{ url_for('onboarding_step', step=5) }}" class="btn btn-outline-secondary">Back</a>
                  <button type="submit" class="btn btn-success" {% if not session.get('plan_tier') %}disabled{% endif %}>Continue</button>
                </div>
              </form>
            {% elif current_step == 7 %}
              <!-- Step 7: File Upload -->
              <h2 class="mb-4">Upload Your Files</h2>
              <p class="text-muted mb-4">Attach recent invoices (4–8 weeks), price lists, inventory sheets, and food cost reports. Multiple files are welcome.</p>
              
              <form method="post" action="{{ url_for('onboarding_step', step=8) }}" enctype="multipart/form-data">
                <div class="mb-4">
                  <label class="form-label">Upload Files</label>
                  <input type="file" name="files" class="form-control" multiple accept=".pdf,.csv,.xlsx,.xls,.docx,.png,.jpg,.jpeg,.heic,.webp,.txt">
                  <div class="form-text">Accepted: PDF, CSV, Excel, Word, Images, Text files • Max 50MB per file</div>
                </div>
                
                <div class="alert alert-info">
                  <h6>What files should I upload?</h6>
                  <ul class="mb-0 small">
                    <li>Recent invoices from your main vendors (last 4-8 weeks)</li>
                    <li>Current price lists or catalogs</li>
                    <li>Inventory sheets or reports</li>
                    <li>Food cost reports or P&L statements</li>
                    <li>Any vendor contracts or agreements</li>
                  </ul>
                </div>
                
                <div class="d-flex justify-content-between">
                  <a href="{{ url_for('onboarding_step', step=6) }}" class="btn btn-outline-secondary">Back</a>
                  <button type="submit" class="btn btn-success">Continue to Checkout</button>
                </div>
              </form>
            {% elif current_step == 8 %}
              <!-- Step 8: Confirmation/Checkout -->
              <h2 class="mb-4">Complete Your Purchase</h2>
              <div class="card mb-4">
                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                      <h3 class="h5 mb-1">
                        {% if session.get('plan_tier') == '1' %}
                          Tier 1 - Purchase Review & Opportunity Report
                        {% elif session.get('plan_tier') == '2' %}
                          Tier 2 - Vendor Negotiation & Price Comparisons
                        {% elif session.get('plan_tier') == '3' %}
                          Tier 3 - Month-End Inventory Audit
                        {% endif %}
                      </h3>
                      <p class="text-muted mb-0">One-time payment</p>
                    </div>
                    <div class="h4 text-success">
                      {% if session.get('plan_tier') == '1' %}
                        $299
                      {% elif session.get('plan_tier') == '2' %}
                        $599
                      {% elif session.get('plan_tier') == '3' %}
                        $999
                      {% endif %}
                    </div>
                  </div>
                  
                  <div class="border-top pt-3">
                    <h6>What's included:</h6>
                    <ul class="small mb-0">
                      {% if session.get('plan_tier') == '1' %}
                        <li>Audit last 4–8 weeks of invoices & price lists</li>
                        <li>Savings by brand/pack/vendor with benchmarks</li>
                        <li>Prioritized action plan</li>
                      {% elif session.get('plan_tier') == '2' %}
                        <li>Everything in Tier 1, plus:</li>
                        <li>We negotiate pricing with current vendors</li>
                        <li>Cross-vendor price comps (including new vendors)</li>
                        <li>Lock savings in writing</li>
                      {% elif session.get('plan_tier') == '3' %}
                        <li>Everything in Tier 1 & 2, plus:</li>
                        <li>End-of-month inventory audit & variance review</li>
                        <li>Count cadence & method tune-up</li>
                        <li>Tie-out to theoretical vs. actual</li>
                      {% endif %}
                    </ul>
                  </div>
                </div>
              </div>
              
              <form method="post" action="{{ url_for('submit') }}">
                <div class="d-flex justify-content-between">
                  <a href="{{ url_for('onboarding_step', step=7) }}" class="btn btn-outline-secondary">Back</a>
                  <button type="submit" class="btn btn-success btn-lg">Complete Purchase & Submit</button>
                </div>
              </form>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
